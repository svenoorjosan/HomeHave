<!-- ====================  GLASSY NAVBAR (sticky & centered)  ==================== -->
<header id="site-header" class="sticky top-4 z-50 mx-auto mb-8 md:mb-10
         w-[95%] sm:w-[90%] lg:w-[80%] xl:w-[70%]
         bg-neutral-800/30 bg-gradient-to-br from-gray-900/80 via-gray-800/70 to-gray-900/80
         backdrop-blur-lg text-white p-4 shadow-xl shadow-black/60 ring-1 ring-white/10
         rounded-2xl overflow-hidden relative">

  <div id="nav-vanta" class="pointer-events-none absolute inset-0"></div>



  <nav class="container mx-auto flex justify-between items-center relative z-10">

    <!-- =============  DESKTOP NAV  ============= -->
    <div class="hidden md:flex md:justify-between md:items-center w-full">
      <ul class="flex items-center flex-wrap gap-2">
        <!-- Home -->
        <li>
          <a href="/" class="<%= currentPage === 'index' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                    py-2 px-4 rounded-lg transition-all duration-300 flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5">
              <path
                d="M11.47 3.84a.75.75 0 011.06 0l8.69 8.69a.75.75 0 101.06-1.06l-8.689-8.69a2.25 2.25 0 00-3.182 0l-8.69 8.69a.75.75 0 001.061 1.06l8.69-8.69z" />
              <path
                d="M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.43z" />
            </svg>
            HomeHave
          </a>
        </li>

        <% if (isLoggedIn) { %>
          <% if (user && user.userType==='guest' ) { %>
            <!-- Homes -->
            <li>
              <a href="/homes" class="<%= currentPage === 'Home' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                   : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                        py-2 px-4 rounded-lg transition-all duration-300 flex items-center gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                  <path
                    d="M19.006 3.705a.75.75 0 00-.512-1.41L6 6.838V3a.75.75 0 00-.75-.75h-1.5A.75.75 0 003 3v4.93l-1.006.365a.75.75 0 00.512 1.41l16.5-6z" />
                  <path fill-rule="evenodd"
                    d="M3.019 11.115L18 5.667V9.09l4.006 1.456a.75.75 0 11-.512 1.41l-.494-.18v8.475h.75a.75.75 0 010 1.5H2.25a.75.75 0 010-1.5H3v-9.129l.019-.006zM18 20.25v-9.565l1.5.545v9.02H18zm-9-6a.75.75 0 00-.75.75v4.5c0 .414.336.75.75.75h3a.75.75 0 00.75-.75V15a.75.75 0 00-.75-.75H9z"
                    clip-rule="evenodd" />
                </svg>
                Homes
              </a>
            </li>

            <!-- Favourites -->
            <li>
              <a href="/favourites" class="<%= currentPage === 'favourites' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                         : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                        py-2 px-4 rounded-lg transition-all duration-300 flex items-center gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                  <path
                    d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0z" />
                </svg>
                Favourites
              </a>
            </li>

            <!-- Bookings -->
            <li>
              <a href="/bookings" class="<%= currentPage === 'bookings' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                       : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                        py-2 px-4 rounded-lg transition-all duration-300 flex items-center gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                  <path
                    d="M6.75 2.25A.75.75 0 017.5 3v1.5h9V3A.75.75 0 0118 3v1.5h.75a3 3 0 013 3v11.25a3 3 0 01-3 3H5.25a3 3 0 01-3-3V7.5a3 3 0 013-3H6V3a.75.75 0 01.75-.75z" />
                  <path d="M12.75 12.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0z" />
                </svg>
                Bookings
              </a>
            </li>
            <% } else { %>
              <!-- Host Homes -->
              <li>
                <a href="/host/host-home-list" class="<%= currentPage === 'host-homes' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                          : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                        py-2 px-4 rounded-lg transition-all duration-300 flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                    <path
                      d="M5.223 2.25c-.497 0-.974.198-1.325.55l-1.3 1.298A3.75 3.75 0 007.5 9.75c.627.47 1.406.75 2.25.75.844 0 1.624-.28 2.25-.75.626.47 1.406.75 2.25.75.844 0 1.567-.182 2.25-.506 1.42.674 3.08.675 4.5.001v8.755h.75a.75.75 0 010 1.5H2.25a.75.75 0 010-1.5H3zm3 6a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v3a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-3zm8.25-.75a.75.75 0 00-.75.75v5.25c0 .414.336.75.75.75h3a.75.75 0 00.75-.75v-5.25a.75.75 0 00-.75-.75h-3z" />
                  </svg>
                  Host Homes
                </a>
              </li>

              <!-- Add Home -->
              <li>
                <a href="/host/add-home" class="<%= currentPage === 'addHome' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                       : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                        py-2 px-4 rounded-lg transition-all duration-300 flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                    <path fill-rule="evenodd"
                      d="M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z"
                      clip-rule="evenodd" />
                  </svg>
                  Add Home
                </a>
              </li>
              <% } %>
                <% } %>
      </ul>

      <!-- ----------  AUTH BUTTONS / LOGOUT  ---------- -->
      <ul class="flex items-center gap-3">
        <% if (!isLoggedIn) { %>
          <li>
            <a href="/signup" class="<%= currentPage === 'signup' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                    : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10 border border-white/20' %>
                      py-2 px-4 rounded-lg transition-all duration-300">
              SignUp
            </a>
          </li>
          <li>
            <a href="/login" class="<%= currentPage === 'login' ? 'bg-white text-red-500 font-medium'
                                                   : 'bg-white/80 text-red-500 hover:bg-red-50' %>
                      py-2 px-4 rounded-lg transition-all duration-300 shadow-sm shadow-black/20">
              Login
            </a>
          </li>
          <% } else { %>
            <li>
              <form action="/logout" method="POST">
                <button type="submit" class="hover:bg-white/10 hover:ring-1 hover:ring-white/10 py-2 px-4 rounded-lg
                             transition-all duration-300 border border-white/20 flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                    <path fill-rule="evenodd"
                      d="M7.5 3.75A1.5 1.5 0 006 5.25v13.5a1.5 1.5 0 001.5 1.5h6a1.5 1.5 0 001.5-1.5V15a.75.75 0 011.5 0v3.75a3 3 0 01-3 3h-6a3 3 0 01-3-3V5.25a3 3 0 013-3h6a3 3 0 013 3V9A.75.75 0 0115 9V5.25a1.5 1.5 0 00-1.5-1.5h-6zm5.03 4.72a.75.75 0 010 1.06l-1.72 1.72h10.94a.75.75 0 010 1.5H10.81l1.72 1.72a.75.75 0 11-1.06 1.06l-3-3a.75.75 0 010-1.06l3-3a.75.75 0 011.06 0z"
                      clip-rule="evenodd" />
                  </svg>
                  Logout
                </button>
              </form>
            </li>
            <% } %>
      </ul>
    </div>

    <!-- =============  MOBILE NAV  ============= -->
    <div class="md:hidden w-full">
      <div class="flex justify-between items-center">
        <a href="/" class="flex items-center py-2 px-3 rounded-lg transition-all duration-300
                  <%= currentPage === 'index' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                             : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
            <path
              d="M11.47 3.84a.75.75 0 011.06 0l8.69 8.69a.75.75 0 101.06-1.06l-8.689-8.69a2.25 2.25 0 00-3.182 0l-8.69 8.69a.75.75 0 001.061 1.06l8.69-8.69z" />
            <path
              d="M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.43z" />
          </svg>
          <span class="ml-1 font-medium">HomeHave</span>
        </a>

        <button id="mobile-menu-button"
          class="p-2 rounded-lg hover:bg-white/10 hover:ring-1 hover:ring-white/10 transition-all duration-300">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
          </svg>
        </button>
      </div>

      <div id="mobile-menu" class="hidden mt-3 border-t border-red-400 pt-3">
        <ul class="flex flex-col space-y-2">
          <% if (isLoggedIn) { %>
            <li><a href="/homes" class="<%= currentPage === 'Home' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                      : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                          py-2 px-3 rounded-lg flex items-center">Homes-List</a></li>
            <li><a href="/favourites" class="<%= currentPage === 'favourites' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                            : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                          py-2 px-3 rounded-lg flex items-center">Favourites</a></li>
            <li><a href="/bookings" class="<%= currentPage === 'bookings' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                          : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                          py-2 px-3 rounded-lg flex items-center">Bookings</a></li>
            <li><a href="/host/host-home-list" class="<%= currentPage === 'host-homes' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                            : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                          py-2 px-3 rounded-lg flex items-center">Host Homes</a></li>
            <li><a href="/host/add-home" class="<%= currentPage === 'addHome' ? 'bg-red-600/80 ring-1 ring-white/10 shadow-md font-medium'
                                                         : 'hover:bg-white/10 hover:ring-1 hover:ring-white/10' %>
                          py-2 px-3 rounded-lg flex items-center">Add Home</a></li>
            <li class="pt-3 border-t border-red-400 mt-3">
              <form action="/logout" method="POST">
                <button type="submit"
                  class="hover:bg-white/10 hover:ring-1 hover:ring-white/10 py-2 px-3 rounded-lg w-full text-left flex items-center">
                  Logout
                </button>
              </form>
            </li>
            <% } else { %>
              <li><a href="/signup"
                  class="hover:bg-white/10 hover:ring-1 hover:ring-white/10 py-2 px-3 rounded-lg block border border-white/20">SignUp</a>
              </li>
              <li><a href="/login"
                  class="bg-white/80 text-red-500 hover:bg-red-50 py-2 px-3 rounded-lg block mt-2 shadow-sm shadow-black/20">Login</a>
              </li>
              <% } %>
        </ul>
      </div>
    </div>
  </nav>
</header>
<!-- make sure these are already on the page once -->
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/vanta/dist/vanta.topology.min.js"></script>

<script>
  window.addEventListener('DOMContentLoaded', () => {
    const mediaReduce = window.matchMedia('(prefers-reduced-motion: reduce)');
    const smallScreen = window.matchMedia('(max-width: 640px)');

    let navVanta;

    function startNavVanta() {
      if (mediaReduce.matches || smallScreen.matches || navVanta) return;
      const el = document.getElementById('nav-vanta');
      if (!el || !window.VANTA) return;

      navVanta = VANTA.TOPOLOGY({
        el,
        // keep the nav interactive; we don't need pointer input for the header
        mouseControls: false,
        touchControls: false,
        gyroControls: false,

        backgroundAlpha: 0.0,     // keep your glass/gradient
        color: 0xa98bfa,          // try 0x60a5fa, 0x22d3ee, 0xa78bfa, or 0xfb7185
        scale: 1.0,
        scaleMobile: 1.0,
        minHeight: 80.0,
        minWidth: 200.0
      });
    }

    function stopNavVanta() {
      if (navVanta) { navVanta.destroy(); navVanta = null; }
    }

    // start/stop based on motion pref and screen size (saves battery on phones)
    startNavVanta();
    mediaReduce.addEventListener('change', () => (mediaReduce.matches ? stopNavVanta() : startNavVanta()));
    smallScreen.addEventListener('change', () => (smallScreen.matches ? stopNavVanta() : startNavVanta()));

    window.addEventListener('beforeunload', stopNavVanta);
  });
</script>